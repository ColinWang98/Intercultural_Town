# Backend Manager - 图形化管理界面

**版本**: v2.1
**更新日期**: 2025-02-08

---

## 快速启动

### Windows
```bash
启动管理器.bat
```

### Linux/Mac
```bash
./start_manager.sh
```

### 或直接运行
```bash
python backend_manager.py
```

---

## 功能说明

### 1. 后端控制

#### ▶ 启动后端
- 启动 FastAPI 后端服务
- 自动显示运行日志
- 端口：127.0.0.1:8000

#### ⏹ 停止后端
- 优雅地停止后端服务
- 自动清理资源

#### 🔍 测试连接
- 测试后端是否正常运行
- 检查 API 响应状态

---

### 2. 端口管理

#### 检查端口
- 检查 8000 端口是否被占用
- 显示占用该端口的进程信息

#### 清理端口
- 自动终止占用 8000 端口的进程
- 显示清理结果

**提示**：如果启动失败，可以先尝试"清理端口"

---

### 3. 模型配置

#### Azure OpenAI (gpt-5-nano)
- 使用 Azure 云端模型
- 需要 .env 文件配置 API Key
- 优点：性能好，稳定性高
- 缺点：需要网络连接，产生费用

#### 本地 Ollama
- 使用本地 Ollama 模型
- 需要 Ollama 服务运行
- 优点：免费，离线可用
- 缺点：需要较好的硬件配置

#### 💾 保存配置
- 保存模型选择到 .env 文件
- **需要重启后端才能生效**

---

### 4. 当前配置显示

实时显示当前配置：
- 模型类型（Azure/Ollama）
- 端点地址
- API 版本
- 配置状态

---

### 5. 运行日志

实时显示后端运行日志：
- `[INFO]` - 信息日志
- `[OK]` - 成功操作
- `[ERROR]` - 错误信息
- `[BACKEND]` - 后端输出

---

### 6. 文档浏览

#### 文档列表
- README.md - 项目主文档
- README_ARCHITECTURE.md - 项目逻辑架构
- README_GAME_OVERVIEW.md - 整体架构说明
- FOLDER_STRUCTURE.md - 文件夹结构
- MAIN_ARCHITECTURE.md - Main.py 架构详解

#### 📖 在浏览器中打开
- 在默认浏览器中打开选中的文档
- 方便查看格式化的文档

---

## 使用流程

### 首次使用

1. **启动管理器**
   ```bash
   启动管理器.bat
   ```

2. **选择模型**
   - Azure OpenAI（推荐）
   - 本地 Ollama

3. **检查配置**
   - 查看"当前配置"显示
   - 确认配置正确

4. **检查端口**
   - 点击"检查端口"
   - 如果被占用，点击"清理端口"

5. **启动后端**
   - 点击"启动后端"
   - 等待日志显示"后端已启动"

6. **测试连接**
   - 点击"测试连接"
   - 确认后端正常响应

### 切换模型

1. 在"模型配置"中选择新的模型
2. 点击"保存配置"
3. 点击"停止后端"（如果正在运行）
4. 点击"启动后端"

### 查看文档

1. 在右侧文档列表中选择文档
2. 内容会自动显示
3. 可点击"在浏览器中打开"查看格式化版本

---

## 常见问题

### Q1: 启动后端失败
**A**:
1. 检查端口是否被占用
2. 点击"清理端口"
3. 确认 Python 依赖已安装
4. 查看日志了解错误信息

### Q2: 测试连接失败
**A**:
1. 确认后端已启动
2. 检查日志中是否有错误
3. 确认防火墙未阻止 8000 端口

### Q3: 切换模型后无效
**A**:
1. 确认点击了"保存配置"
2. 必须重启后端才能生效
3. 检查 .env 文件是否正确

### Q4: Azure 连接失败
**A**:
1. 检查 API Key 是否正确
2. 检查网络连接
3. 确认 Azure 端点地址正确

---

## 界面截图说明

### 左侧面板
- **后端控制**: 启动/停止/测试
- **端口管理**: 检查/清理 8000 端口
- **模型配置**: 切换 Azure/Ollama
- **运行日志**: 实时日志显示

### 右侧面板
- **文档列表**: 所有可用文档
- **文档内容**: 实时预览
- **浏览器打开**: 新窗口查看

---

## 技术细节

### 依赖库
- `tkinter` - GUI 框架（Python 内置）
- `requests` - HTTP 请求
- `python-dotenv` - 环境变量管理

### 配置文件
- `.env` - 环境变量配置
- `Main.py` - 后端主程序
- `personas.py` - Persona 配置

### 日志级别
- INFO - 一般信息
- SUCCESS - 成功操作
- ERROR - 错误信息
- BACKEND - 后端输出

---

## 快捷键

暂无，计划添加：
- Ctrl+S - 保存配置
- Ctrl+R - 启动后端
- Ctrl+T - 停止后端
- Ctrl+Q - 退出程序

---

## 更新日志

### v2.1 (2025-02-08)
- ✅ 添加图形化管理界面
- ✅ 集成端口管理功能
- ✅ 支持模型切换
- ✅ 集成文档浏览
- ✅ 实时日志显示

---

**开发者**: Claude Sonnet 4.5
**许可**: MIT
**状态**: ✅ 生产就绪
